delete window.AunoaChat,delete window.aunoachat,delete window.AUNOA_LOADED,delete window._aunoa_startChat;var AUNOA_LOADED=!1;if(void 0===AUNOA_COLOR)var AUNOA_COLOR="";if(void 0===AUNOA_TITLE)var AUNOA_TITLE="";if(void 0===AUNOA_START)var AUNOA_START="";if(void 0===AUNOA_WHATSAPP)var AUNOA_WHATSAPP="";if(void 0===AUNOA_WHATSAPP_CHATICON)var AUNOA_WHATSAPP_CHATICON="";if(void 0===AUNOA_CHATICON_BG)var AUNOA_CHATICON_BG="";if(void 0===AUNOA_NEWSESSION)var AUNOA_NEWSESSION="";var AunoaChat=function(){this.id=0,this.botid="",this.chaticon="",this.boticon="",this.loaded=!1,this.hideicon=!1,this.opennow=!1,this.userData={},this.userData.userInfo={},this.maxHistory=20,this.showattach=!1,this.flush=!1,this.events=[],this.getBotId(),this.loadUTM();var self=this;this.webrtcconfig,this.webrtcconfigTemplate={channel:"",openSocket:function(config){var SIGNALING_SERVER=$aunoaConfig.webrtcEndpoint;Math.round(999999999*Math.random());config.channel=config.channel||self.webrtcconfig.channel;var sender=Math.round(999999999*Math.random())+999999999;io.connect(SIGNALING_SERVER).emit("new-channel",{channel:config.channel,sender:sender});var socket=io.connect(SIGNALING_SERVER+config.channel);socket.channel=config.channel,socket.on("connect",function(){config.callback&&config.callback(socket)}),socket.send=function(message){socket.emit("message",{sender:sender,data:message})},socket.on("message",config.onmessage)},onRemoteStream:function(media){if(!isbroadcaster){var video=media.video;videosContainer.insertBefore(video,videosContainer.firstChild)}},onRoomFound:function(room){isbroadcaster||conferenceUI.joinRoom({roomToken:room.roomToken,joinUser:room.broadcaster})},onNewParticipant:function(numberOfParticipants){var text=numberOfParticipants+" users are viewing your screen!";numberOfParticipants<=0?text="AGENTNOTCONNECTED":1==numberOfParticipants&&(text="AGENTCONNECTED"),self.webrtcconfig.lastText!=text&&(self.webrtcconfig.lastText=text,""!=text&&document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "localMessage","msg": "'+text+'"}',"*"))},oniceconnectionstatechange:function(state){var text="";"closed"!=state&&"disconnected"!=state||(text="AGENTLEFT"),"failed"==state&&(text="FAILEDTOCONNECT"),"connected"!=state&&"completed"!=state||(text="AGENTCONNECTED"),"new"!=state&&"checking"!=state||(text="AGENTTRYINGTOCONNECT"),self.webrtcconfig.lastText!=text&&(self.webrtcconfig.lastText=text,""!=text&&document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "localMessage","msg": "'+text+'"}',"*"))}}};AunoaChat.prototype.startVideoSharing=function(type,name){this.conferenceUI&&this.stopVideoSharing(),this.webrtcconfig=Object.assign({},this.webrtcconfigTemplate),this.webrtcconfig.channel=name,this.conferenceUI=new AunoaConference(this.webrtcconfig);var roomName_name="room",self=this;self.captureUserMedia(type,function(){self.conferenceUI.createRoom({roomName:roomName_name})})},AunoaChat.prototype.stopVideoSharing=function(){if(this.conferenceUI){this.conferenceUI.leave();var video=document.getElementById("aunoa-video");video&&video.parentElement.removeChild(video),document.getElementById("aunoa-videos-container").style.display="none",Object.keys(io.sockets).forEach(function(s){io.sockets[s].disconnect(),delete io.sockets[s]}),this.conferenceUI=void 0}document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "stopScreensharing"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "stopWebcam"}',"*")},AunoaChat.prototype.dragable=function(elem){var bbox,startX,startY,deltaX,deltaY,raf;function userMoved(event){raf||(deltaX=event.clientX-startX,deltaY=event.clientY-startY,elem.style.transform="translate3d("+deltaX+"px,"+deltaY+"px, 0px)")}function userReleased(event){elem.removeEventListener("pointermove",userMoved),elem.removeEventListener("pointerup",userReleased),elem.removeEventListener("pointercancel",userReleased),elem.style.left=bbox.left+deltaX+"px",elem.style.top=bbox.top+deltaY+"px",elem.style.transform="translate3d(0px,0px,0px)",deltaX=deltaY=null}elem.addEventListener("pointerdown",function(event){event.target,startX=event.clientX,startY=event.clientY,bbox=elem.getBoundingClientRect(),elem.addEventListener("pointermove",userMoved,{passive:!0}),elem.addEventListener("pointerup",userReleased,{passive:!0}),elem.addEventListener("pointercancel",userReleased,{passive:!0})},{passive:!0}),elem.style.cursor="move"},AunoaChat.prototype.captureUserMedia=function(type,callback){var self=this,video=document.createElement("video");video.muted=!0,video.volume=0,video.setAttribute("id","aunoa-video"),video.setAttribute("autoplay",!0),video.setAttribute("playsinline",!0);var videosContainer=document.getElementById("aunoa-videos-container");function onGettingSteam(stream){var chatpos=document.getElementById("aunoa-webchat").getBoundingClientRect();video.srcObject=stream,videosContainer.insertBefore(video,videosContainer.firstChild),videosContainer.style.top=chatpos.top+"px",videosContainer.style.left=chatpos.left-150+"px",videosContainer.style.right="auto",videosContainer.style.display="block",self.dragable(videosContainer),self.conferenceUI.addStreamStopListener(stream,function(){var video=document.getElementById("aunoa-video");video&&video.parentElement.removeChild(video),self.stopVideoSharing(),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "stopScreensharing"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "stopWebcam"}',"*")}),self.webrtcconfig.attachStream=stream,document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "openMedia"}',"*"),callback&&callback()}function getDisplayMediaError(error){self.stopVideoSharing(),console.log(error)}"webcam"==type&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:!0}).then(function(stream){onGettingSteam(stream)},getDisplayMediaError).catch(getDisplayMediaError):"screen"==type&&(navigator.getDisplayMedia||navigator.mediaDevices.getDisplayMedia)?navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia({video:!0}).then(function(stream){onGettingSteam(stream)},getDisplayMediaError).catch(getDisplayMediaError):navigator.getDisplayMedia&&navigator.getDisplayMedia({video:!0}).then(function(stream){onGettingSteam(stream)},getDisplayMediaError).catch(getDisplayMediaError):console.log("NOT SUPPOERTED BROWSER")},AunoaChat.prototype.parseUrlParams=function(e){this.userData.currentPage=window.location.href;var t=function(e){var t=document.createElement("a");return t.href=e,t.search.split("?")[1]||""}(e);return""===t?{}:t.split("&").reduce(function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e},{})},AunoaChat.prototype.getBotId=function(){var scriptURL=this.getScriptURL(),params=this.parseUrlParams(scriptURL);params.botid&&(window.AUNOA_BOT=params.botid,this.botid=params.botid),params.flush&&"true"==params.flush&&(this.flush=!0)},AunoaChat.prototype.loadUTM=function(){var urlParams=new URLSearchParams(window.location.search),searchVars=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"];for(var i in searchVars){var svar=searchVars[i];urlParams.has(svar)&&(this.userData[svar]=urlParams.get(svar))}this.loadAnalitics()},AunoaChat.prototype.loadAnalitics=function(){var browser=this.getBrowserInfo();for(var i in browser)this.userData.userInfo[i]=browser[i]},AunoaChat.prototype.getBrowserInfo=function(){var n="";screen.width&&(width=screen.width?screen.width:"",height=screen.height?screen.height:"",n+=width+" x "+height);var i,s,e,r=navigator.appVersion,o=navigator.userAgent,d=navigator.appName,a=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10);-1!=(s=o.indexOf("Opera"))?(d="Opera",a=o.substring(s+6),-1!=(s=o.indexOf("Version"))&&(a=o.substring(s+8))):-1!=(s=o.indexOf("MSIE"))?(d="Microsoft Internet Explorer",a=o.substring(s+5)):"Netscape"==d&&-1!=o.indexOf("Trident/")?(d="Microsoft Internet Explorer",a=o.substring(s+5),-1!=(s=o.indexOf("rv:"))&&(a=o.substring(s+3))):-1!=(s=o.indexOf("Chrome"))?(d="Chrome",a=o.substring(s+7)):-1!=(s=o.indexOf("Safari"))?(d="Safari",a=o.substring(s+7),-1!=(s=o.indexOf("Version"))&&(a=o.substring(s+8)),-1!=o.indexOf("CriOS")&&(d="Chrome")):-1!=(s=o.indexOf("Firefox"))?(d="Firefox",a=o.substring(s+8)):(i=o.lastIndexOf(" ")+1)<(s=o.lastIndexOf("/"))&&(d=o.substring(i,s),a=o.substring(s+1),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName)),-1!=(e=a.indexOf(";"))&&(a=a.substring(0,e)),-1!=(e=a.indexOf(" "))&&(a=a.substring(0,e)),-1!=(e=a.indexOf(")"))&&(a=a.substring(0,e)),t=parseInt(""+a,10),isNaN(t)&&(a=""+parseFloat(navigator.appVersion),t=parseInt(navigator.appVersion,10));var w=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(r),W=!!navigator.cookieEnabled;void 0!==navigator.cookieEnabled||W||(document.cookie="testcookie",W=-1!=document.cookie.indexOf("testcookie"));var c="Unknown",O=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var p in O){var g=O[p];if(g.r.test(o)){c=g.s;break}}var x="Unknown";switch(/Windows/.test(c)&&(x=/Windows (.*)/.exec(c)[1],c="Windows"),c){case"Mac OS X":x=/Mac OS X (10[\.\_\d]+)/.exec(o)[1];break;case"Android":x=/Android ([\.\_\d]+)/.exec(o)[1];break;case"iOS":x=(x=/OS (\d+)_(\d+)_?(\d+)?/.exec(r))[1]+"."+x[2]+"."+(0|x[3])}return{screen:n,browser:d,browserVersion:a,mobile:w,os:c,osVersion:x,cookies:W}},AunoaChat.prototype.getScriptURL=function(){return(document.currentScript||document.querySelector('script[src*="widget/widget.js"]')).src},AunoaChat.prototype.loadConfig=function(){var url=this.getScriptURL(),host=(url=new URL(url)).protocol+"//"+url.host+"/scripts/config/env.js";this.loadScript(host,_aunoa_init__webchat)},AunoaChat.prototype.loadScript=function(url,callback){var se=document.createElement("script");se.type="text/javascript",se.src=url,callback&&(se.onload=function(){callback()}),document.head.appendChild(se)},AunoaChat.prototype.loadVideoSharing=function(type){if("webcam"==type){if(!navigator.mediaDevices.getUserMedia)return void document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "webcamUnsupported"}',"*")}else if(!navigator.getDisplayMedia&&!navigator.mediaDevices.getDisplayMedia)return void document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "screenshareUnsupported"}',"*");this.div=document.createElement("div"),this.div.className="aunoa-floating-video",this.div.setAttribute("id","aunoa-videos-container"),document.body.appendChild(this.div);var self=this,url=this.getScriptURL(),host=(url=new URL(url)).protocol+"//"+url.host;self.loadScript(host+"/scripts/webrtc/webrtc.all.min.js",function(){self.loadScript(host+"/scripts/webrtc/conference.min.js",function(){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "cobrowsingLoaded"}',"*")})})},AunoaChat.prototype.setShowAttach=function(show){this.showattach=show},AunoaChat.prototype.setHideIcon=function(hide){this.hideicon=hide},AunoaChat.prototype.setChatIcon=function(icon){this.chaticon=icon},AunoaChat.prototype.setBotIcon=function(icon){this.boticon=icon},AunoaChat.prototype.setMaxHistory=function(maxh){this.maxHistory=maxh},AunoaChat.prototype.openChatAfter=function(timeout){0==timeout?this.opennow=!0:setTimeout(function(){aunoachat.openChat()},1e3*timeout)},AunoaChat.prototype.on=function(event,cb){this.events[event]||(this.events[event]=[]),this.events[event].push(cb)},AunoaChat.prototype.off=function(event,cb){if(this.events[event]){var idx=this.events[event].indexOf(cb);idx>=0&&this.events[event].splice(idx,1)}},AunoaChat.prototype.openChat=function(){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "openChat"}',"*")},AunoaChat.prototype.addContext=function(data){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "addContext", "message": '+JSON.stringify(data)+"}","*")},AunoaChat.prototype.toggleChat=function(){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "toggleChat"}',"*")},AunoaChat.prototype.send=function(msg){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "sendMsg", "message": "'+msg+'"}',"*")},AunoaChat.prototype.closeChat=function(){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "closeChat"}',"*")},AunoaChat.prototype.addCss=function(){var mycss=document.createElement("style");mycss.type="text/css",mycss.styleSheet?mycss.styleSheet.cssText="#aunoa-videos-container{display:none;position:absolute;top:10px;right:10px;width:150px;border: 1px solid grey;}#aunoa-wraper{z-index: 2147483639;} #aunoa-webchat {background-color: transparent;pointer-events: none;z-index: 2147483639;max-height: 100%;position: fixed;right: 17px;bottom: 10px;border: 0px;width: 100px;height: 100px;overflow: hidden;visibility: visible;}":mycss.appendChild(document.createTextNode("#aunoa-videos-container{display:none;position:absolute;top:10px;right:10px;width:150px;border: 1px solid grey;}#aunoa-wraper{z-index: 2147483639;}#aunoa-webchat {background-color: transparent;pointer-events: none;z-index: 2147483639;max-height: 100%;position: fixed;right: 17px;bottom: 10px;border: 0px;width: 100px;height: 100px;overflow: hidden;visibility: visible;}")),document.getElementsByTagName("head")[0].appendChild(mycss)},AunoaChat.prototype.loadAunoaChat=function(){this.loaded=!0;try{var self=this;this.addCss();var code='<div id="aunoa-webchat" class="closed" style="background-color: transparent; pointer-events: none; z-index: 2147483639; max-height: 100%; position: fixed; right: 17px; bottom: 10px; border: 0px; width: 100px; height: 100px; overflow: hidden; visibility: visible;">';code+='<iframe src="'+$aunoaConfig.webchatUrl+"?"+AUNOA_BOT+";%25"+AUNOA_COLOR+";"+encodeURI(AUNOA_START)+";"+encodeURI(AUNOA_TITLE)+";"+encodeURI(AUNOA_NEWSESSION)+";"+encodeURI(AUNOA_WHATSAPP)+";"+encodeURI(AUNOA_CHATICON_BG)+";&flush="+self.flush+'" id="aunoa-webchat-frame" style="pointer-events: all; background: none; border: 0px; float: none; position: absolute; top: 0px; right: 0px; bottom: 0px; left: 0px; width: 100%; height: 100%; margin: 0px; padding: 0px;"></iframe>',code+="</div>",this.div=document.createElement("div"),this.div.className="aunoa-wraper",this.div.setAttribute("id","aunoa-wraper"),this.div.innerHTML=code,document.body.appendChild(this.div),AUNOA_LOADED=!0,window.addEventListener("resize",function(){document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "windowWidth", "value": '+window.innerWidth+"}","*");var videosContainer=document.getElementById("aunoa-videos-container");if(videosContainer){var chatpos=document.getElementById("aunoa-webchat").getBoundingClientRect();videosContainer.style.top=chatpos.top+"px",videosContainer.style.left=chatpos.left-150+"px",videosContainer.style.right="auto"}}),window.addEventListener("message",function(event){if(-1!=["https://webchatbot.aunoa.ai","https://webchatbot.staging.aunoa.ai","http://localhost:9020"].indexOf(event.origin)&&""!=event.data)try{var data=JSON.parse(event.data),r="17px",b="10px";if("openChat"==data.action){var w="410px",h="720px";window.innerWidth<720?(w="100%",h="100%",r="0px",b="0px",document.getElementById("aunoa-webchat").classList.add("fullscreen")):document.getElementById("aunoa-webchat").classList.remove("fullscreen"),document.getElementById("aunoa-webchat").style.width=w,document.getElementById("aunoa-webchat").style.height=h,document.getElementById("aunoa-webchat").style.right=r,document.getElementById("aunoa-webchat").style.bottom=b,document.getElementById("aunoa-webchat").classList.remove("closed"),document.getElementById("aunoa-webchat").classList.add("opened")}"closeChat"==data.action&&(document.getElementById("aunoa-webchat").style.right=r,document.getElementById("aunoa-webchat").style.bottom=b,document.getElementById("aunoa-webchat").classList.remove("opened"),document.getElementById("aunoa-webchat").classList.add("closed"),setTimeout(function(){document.getElementById("aunoa-webchat").style.width="100px",document.getElementById("aunoa-webchat").style.height="100px"},500)),"isMobile"==data.action&&document.getElementById("aunoa-webchat").classList.add("ismobile"),"event"==data.action&&data.event&&self.events[data.event]&&(data.arguments||(data.arguments=[]),self.events[data.event].forEach(function(cb){"function"==typeof cb&&cb.apply(null,data.arguments)})),"loaded"==data.action&&("undefined"!=typeof AUNOA_USER_DATA&&(self.userData=Object.assign(self.userData,AUNOA_USER_DATA)),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "addUserParams", "value": '+JSON.stringify(self.userData)+"}","*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "hideicon", "value": "'+self.hideicon+'"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "showattach", "value": "'+self.showattach+'"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "boticon", "value": "'+self.boticon+'"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "chaticon", "value": "'+self.chaticon+'"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "windowWidth", "value": '+window.innerWidth+"}","*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "whatsappchaticon", "value": "'+AUNOA_WHATSAPP_CHATICON+'"}',"*"),document.getElementById("aunoa-webchat-frame").contentWindow.postMessage('{"action": "maxHistory", "value": "'+self.maxHistory+'"}',"*"),self.opennow&&self.openChat()),"screenshare"==data.action&&self.loadVideoSharing("screen"),"webcam"==data.action&&self.loadVideoSharing("webcam"),"startScreensharing"==data.action&&self.startVideoSharing("screen",data.name),"stopScreensharing"==data.action&&self.stopVideoSharing(),"startWebcam"==data.action&&self.startVideoSharing("webcam",data.name),"stopWebcam"==data.action&&self.stopVideoSharing(),"openBrowser"==data.action&&(0!=data.url.indexOf("http://")&&0!=data.url.indexOf("https://")||(window.innerWidth>820?setTimeout(function(){document.getElementById("aunoa-webchat").style.width="820px",document.getElementById("aunoa-webchat").style.height="720px"},500):window.open(data.url)))}catch(err){}})}catch(err){console.log(err)}};var aunoachat=new AunoaChat;function _aunoa_init__webchat(){"undefined"!=typeof AUNOA_ATTACH&&aunoachat.setShowAttach(AUNOA_ATTACH),"undefined"!=typeof AUNOA_HIDEICON&&aunoachat.setHideIcon(AUNOA_HIDEICON),"undefined"!=typeof AUNOA_CHATICON&&aunoachat.setChatIcon(AUNOA_CHATICON),"undefined"!=typeof AUNOA_BOTICON&&aunoachat.setBotIcon(AUNOA_BOTICON),"undefined"!=typeof AUNOA_MAXHISTORY&&aunoachat.setMaxHistory(AUNOA_MAXHISTORY),aunoachat.loadAunoaChat(),"undefined"!=typeof AUNOA_OPENDELAY&&aunoachat.openChatAfter(AUNOA_OPENDELAY)}function _aunoa_startChat(){aunoachat.loaded||(aunoachat.loaded=!0,aunoachat.loadConfig())}document.addEventListener("DOMContentLoaded",function(event){_aunoa_startChat()}),window.addEventListener?window.addEventListener("load",_aunoa_startChat(),!1):window.attachEvent&&window.attachEvent("onload",_aunoa_startChat());